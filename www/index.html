<!DOCTYPE>

<html>

<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
</head>

<body onload="preloadStationList()">
    <h2>Train Information from Indian Railways API</h2>
    <form>
        <div>
            Station 1: <input id="tags1" >
        </div>
        <div class="ui-widget">
            Station 1: <input id="tags2">
        </div>
        <a href="page2.html" onclick="storeSessionVariables();">HI</a>
    </form>
    <script>
        var stationList = [];
        var stationCode = [];


        function preloadStationList() {
            $.ajax({
                type: 'GET',
                url: 'http://api.erail.in/stations/?key=3d970b43-550b-4568-9227-492697f47093',
                dataType: 'json',
                success: function (data) {

                    for (var i = 0; i < data.length; i++) {
                        stationList[i] = data[i].name;
                        stationCode[i] = data[i].code;
                    }
                },
                error: function (x, e) {
                    alert('ERROR');
                }
            });
        }

        $(function () {
            $("#tags1").autocomplete({
                source: stationList
            });
        });

        $(function () {
            $("#tags2").autocomplete({
                source: stationList
            });
        });

        function storeSessionVariables() {
            //alert(document.getElementById('tags1').value);
            if (typeof (Storage) != "undefined") {
                //fetching respective station code
                var stCode1 = stationCode[stationList.indexOf(document.getElementById('tags1').value)];
                var stCode2 = stationCode[stationList.indexOf(document.getElementById('tags2').value)];
                // Store variable in local storage (Acts as session). Feature of HTML 5
                localStorage.setItem("station1", stCode1);
                localStorage.setItem("station2", stCode2);

            }
        }

    </script>
</body>

</html>